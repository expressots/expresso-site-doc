"use strict";(self.webpackChunkclassic=self.webpackChunkclassic||[]).push([[1689],{7342:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"features/dto-validator","title":"DTO validator","description":"DTO validator provider.","source":"@site/versioned_docs/version-3.0.0/features/dto-validator.mdx","sourceDirName":"features","slug":"/features/dto-validator","permalink":"/docs/features/dto-validator","draft":false,"unlisted":false,"tags":[],"version":"3.0.0","sidebarPosition":7,"frontMatter":{"sidebar_position":7,"title":"DTO validator","description":"DTO validator provider."},"sidebar":"tutorialSidebar","previous":{"title":"ExpressoTS config","permalink":"/docs/features/expressots-config"},"next":{"title":"Env validator","permalink":"/docs/features/envvalidator"}}');var r=t(4848),n=t(8453);const i={sidebar_position:7,title:"DTO validator",description:"DTO validator provider."},o="Payload",d={},l=[{value:"DTO pattern",id:"dto-pattern",level:2},{value:"DTO validator",id:"dto-validator",level:2},{value:"Pre requisites",id:"pre-requisites",level:2},{value:"Usage example",id:"usage-example",level:2},{value:"Error messages",id:"error-messages",level:2},{value:"Support us \u2764\ufe0f",id:"support-us-\ufe0f",level:2}];function c(e){const a={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.header,{children:(0,r.jsx)(a.h1,{id:"payload",children:"Payload"})}),"\n",(0,r.jsx)(a.p,{children:"A payload in a web application refers to the data sent between the client and server, typically within a request body. This data is essential for performing operations like creating, updating, or retrieving resources. Payloads contain the information that the server needs to process a request and return an appropriate response."}),"\n",(0,r.jsx)(a.h2,{id:"dto-pattern",children:"DTO pattern"}),"\n",(0,r.jsx)(a.p,{children:"The Data Transfer Object (DTO) pattern is used to standardize the structure of this payload data as it moves between different layers of the application. DTOs ensure that the data being transferred adheres to specific formats, making it easier to manage and validate. By separating the data structure from business logic, DTOs help keep the application modular, maintainable, and less prone to errors."}),"\n",(0,r.jsx)(a.h2,{id:"dto-validator",children:"DTO validator"}),"\n",(0,r.jsx)(a.p,{children:"The DTO Validator in ExpressoTS plays a critical role in ensuring the integrity of incoming payloads. This provider validates the data sent by the client, checking for required fields, data types, and overall consistency. By doing so, it helps developers avoid runtime errors that could occur due to missing or invalid data."}),"\n",(0,r.jsx)(a.p,{children:"When you scaffold a new ExpressoTS project, the DTO Validator is included as middleware named validateDTO. This middleware can be applied to any endpoint to automatically validate incoming data against the defined DTO structure before the request is processed further. This validation step ensures that only well-formed, valid data enters your application's processing pipeline, enhancing reliability and security."}),"\n",(0,r.jsx)(a.h2,{id:"pre-requisites",children:"Pre requisites"}),"\n",(0,r.jsxs)(a.p,{children:["The DTO validator is based on the ",(0,r.jsx)(a.a,{href:"https://www.npmjs.com/package/class-validator",children:"class-validator"})," and ",(0,r.jsx)(a.a,{href:"https://www.npmjs.com/package/class-transformer",children:"class-transformer"})," packages. It uses decorators to validate the DTOs."]}),"\n",(0,r.jsx)(a.admonition,{type:"caution",children:(0,r.jsx)(a.p,{children:"If you don't have class-validator and class-transformer installed and try to use the DTO validator, you will get an warning message in the console mentioning that you need to install the packages."})}),"\n",(0,r.jsx)(a.p,{children:"Another key point is that the DTO Validator works exclusively with classes, as interfaces do not exist at runtime. Therefore, if you want to use the DTO Validator, you'll need to change the interface provided by ExpressoTS to a class that represents your DTO instead. This allows the validator to properly validate the incoming data, ensuring it adheres to the defined structure."}),"\n",(0,r.jsx)(a.h2,{id:"usage-example",children:"Usage example"}),"\n",(0,r.jsxs)(a.p,{children:["You can use the DTO validator in any endpoint by adding the ",(0,r.jsx)(a.code,{children:"validateDTO"})," middleware in the endpoint route."]}),"\n",(0,r.jsx)(a.p,{children:"Endpoint that creates a new user:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-typescript",children:'@httpPost("/", ValidateDTO(CreateUserDTO))\nexecute(@requestBody() payload: CreateUserDTO, @response() res: Response) {\n  return res.status(StatusCode.Created).json(this.createUserUseCase.execute(payload));\n}\n'})}),"\n",(0,r.jsxs)(a.p,{children:["Here it is the ",(0,r.jsx)(a.code,{children:"CreateUserDTO"})," class:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-typescript",children:'import { IsEmail, IsNotEmpty, MinLength } from "class-validator";\n\nclass CreateUserDTO {\n    @IsNotEmpty()\n    @MinLength(10)\n    name: string;\n    @IsNotEmpty()\n    @IsEmail({}, { message: "Invalid email" })\n    email: string;\n}\n\nexport { CreateUserDTO };\n'})}),"\n",(0,r.jsx)(a.admonition,{type:"info",children:(0,r.jsxs)(a.p,{children:["For more information about the decorators, please check the ",(0,r.jsx)(a.a,{href:"https://www.npmjs.com/package/class-validator",children:"class-validator"})," package."]})}),"\n",(0,r.jsx)(a.h2,{id:"error-messages",children:"Error messages"}),"\n",(0,r.jsxs)(a.p,{children:["If you submit a payload that doesn't match the DTO ",(0,r.jsx)(a.code,{children:"CreateUserDTO"})," above, the DTO validator will return an error message with the following format:"]}),"\n",(0,r.jsx)(a.p,{children:(0,r.jsx)(a.strong,{children:"Payload:"})}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-json",metastring:'title="Invalid payload"',children:'{\n    "name": "",\n    "email": ""\n}\n'})}),"\n",(0,r.jsx)(a.p,{children:(0,r.jsx)(a.strong,{children:"Response:"})}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-json",children:'{\n    "errorCode": 400,\n    "errorMessage": "Bad Request",\n    "DTO": [\n        {\n            "property": "name",\n            "messages": [\n                "name must be longer than or equal to 10 characters",\n                "name should not be empty"\n            ]\n        },\n        {\n            "property": "email",\n            "messages": ["invalid email", "email should not be empty"]\n        }\n    ]\n}\n'})}),"\n",(0,r.jsx)(a.p,{children:"Messages are split by property, so you can easily identify which property has an error and what is the error message. This is useful when you have a DTO with a lot of properties, as you can easily identify which property has an error. It also helps the frontend application on getting the error messages more easily."}),"\n",(0,r.jsx)(a.hr,{}),"\n",(0,r.jsx)(a.h2,{id:"support-us-\ufe0f",children:"Support us \u2764\ufe0f"}),"\n",(0,r.jsxs)(a.p,{children:["ExpressoTS is an MIT-licensed open source project. It's an independent project with ongoing development made possible thanks to your support.\nIf you'd like to help, please read our ",(0,r.jsx)(a.strong,{children:(0,r.jsx)(a.a,{href:"/docs/support-us",children:"support guide"})}),"."]})]})}function p(e={}){const{wrapper:a}={...(0,n.R)(),...e.components};return a?(0,r.jsx)(a,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,a,t)=>{t.d(a,{R:()=>i,x:()=>o});var s=t(6540);const r={},n=s.createContext(r);function i(e){const a=s.useContext(n);return s.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(n.Provider,{value:a},e.children)}}}]);